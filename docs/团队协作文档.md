# TapLive MVP 团队协作文档
## 专业级国际团队开发指南

### 项目概览
TapLive MVP是一个面向ETH Global黑客马拉松的位置驱动实时视频流平台，旨在将闲置人员和智能设备整合到视频流供应链中。本文档为国际化开发团队提供完整的协作指南，涵盖开发流程、代码标准、沟通协议和项目管理规范。

---

## 团队结构与职责

### 核心团队角色

#### 1. **技术负责人 (Technical Lead)**
- **职责**: 技术架构决策，代码审查，技术标准制定
- **技能要求**: React, Node.js, PostgreSQL, WebRTC, 区块链集成
- **工作内容**: 
  - 系统架构设计与优化
  - 关键技术难点攻克
  - 代码质量把控
  - 团队技术指导

#### 2. **前端开发工程师 (Frontend Developer)**
- **职责**: React用户界面开发，用户体验优化
- **技能要求**: React 18, TypeScript, shadcn/ui, Tailwind CSS
- **工作内容**:
  - 响应式UI组件开发
  - 多语言国际化实现
  - 实时流媒体界面集成
  - 性能优化与用户体验提升

#### 3. **后端开发工程师 (Backend Developer)**
- **职责**: API开发，数据库设计，系统集成
- **技能要求**: Node.js, Express, PostgreSQL, Drizzle ORM
- **工作内容**:
  - RESTful API设计与开发
  - 数据库架构设计
  - 支付系统集成
  - 实时通信系统构建

#### 4. **全栈开发工程师 (Full-stack Developer)**
- **职责**: 前后端联调，功能完整性保障
- **技能要求**: 全栈技术能力，系统集成经验
- **工作内容**:
  - 端到端功能开发
  - 系统集成测试
  - 性能调优
  - 部署与运维支持

#### 5. **产品经理 (Product Manager)**
- **职责**: 需求管理，用户体验设计，项目进度控制
- **技能要求**: 产品设计，用户研究，项目管理
- **工作内容**:
  - 产品需求定义与优化
  - 用户体验流程设计
  - 项目进度管理
  - 团队沟通协调

---

## 开发流程规范

### 1. Git工作流程

#### 分支策略
```
main              # 主分支 - 生产环境代码
├── develop       # 开发分支 - 集成测试
├── feature/*     # 功能分支 - 新功能开发
├── bugfix/*      # 修复分支 - Bug修复
└── release/*     # 发布分支 - 版本准备
```

#### 分支命名规范
```bash
# 功能开发
feature/order-management
feature/payment-integration
feature/multi-stream-grid

# Bug修复
bugfix/payment-error-handling
bugfix/stream-connection-issue

# 发布准备
release/v1.0.0
release/v1.1.0
```

#### 提交信息规范
```bash
# 格式: <type>(<scope>): <subject>
# 类型:
feat: 新功能
fix: Bug修复
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建工具或辅助工具的变动

# 示例:
feat(orders): add real-time order status updates
fix(payment): resolve Stripe payment confirmation issue
docs(api): update payment API documentation
```

### 2. 代码审查流程

#### Pull Request模板
```markdown
## 功能描述
简要描述本次提交的功能或修复

## 变更类型
- [ ] 新功能
- [ ] Bug修复
- [ ] 性能优化
- [ ] 代码重构
- [ ] 文档更新

## 测试情况
- [ ] 单元测试已通过
- [ ] 集成测试已完成
- [ ] 手动测试已验证

## 检查清单
- [ ] 代码符合团队规范
- [ ] 无TypeScript类型错误
- [ ] 无ESLint警告
- [ ] 已更新相关文档

## 相关Issue
Closes #123
```

#### 代码审查标准
1. **功能正确性**: 代码逻辑正确，满足需求
2. **代码质量**: 结构清晰，注释充分，易于维护
3. **性能考虑**: 无明显性能问题，适当的优化
4. **安全性**: 无安全漏洞，输入验证完整
5. **测试覆盖**: 关键逻辑有测试覆盖

### 3. 开发环境配置

#### 必需工具
```bash
# Node.js版本管理
nvm use 18.x

# 包管理器
npm install

# 代码格式化
prettier --config .prettierrc

# 代码检查
eslint --config .eslintrc.js

# 类型检查
tsc --noEmit
```

#### 推荐VSCode插件
```json
{
  "recommendations": [
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-json"
  ]
}
```

---

## 编码规范

### 1. TypeScript规范

#### 类型定义
```typescript
// 使用interface定义对象类型
interface Order {
  id: string;
  title: string;
  status: OrderStatus;
  createdAt: Date;
}

// 使用type定义联合类型
type OrderStatus = 'pending' | 'accepted' | 'live' | 'completed';

// 严格的类型导入
import type { Order } from '@shared/schema';
```

#### 函数定义
```typescript
// 明确的返回类型
const createOrder = async (data: CreateOrderData): Promise<Order> => {
  // 实现逻辑
};

// 使用泛型提高复用性
const apiRequest = async <T>(endpoint: string): Promise<ApiResponse<T>> => {
  // API请求逻辑
};
```

### 2. React组件规范

#### 函数组件结构
```typescript
// 组件Props接口定义
interface OrderCardProps {
  order: Order;
  onStatusChange: (id: string, status: OrderStatus) => void;
  className?: string;
}

// 组件实现
export const OrderCard: React.FC<OrderCardProps> = ({
  order,
  onStatusChange,
  className
}) => {
  // Hooks在顶部
  const { toast } = useToast();
  const [isLoading, setIsLoading] = useState(false);

  // 事件处理函数
  const handleStatusChange = useCallback((newStatus: OrderStatus) => {
    onStatusChange(order.id, newStatus);
  }, [order.id, onStatusChange]);

  // 渲染逻辑
  return (
    <Card className={cn("order-card", className)}>
      {/* JSX内容 */}
    </Card>
  );
};
```

#### Hook使用规范
```typescript
// 自定义Hook
export const useOrderManagement = () => {
  const queryClient = useQueryClient();
  
  const createOrder = useMutation({
    mutationFn: api.orders.create,
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['/api/orders'] });
      toast({ title: "订单创建成功" });
    },
    onError: (error) => {
      toast({ 
        title: "创建失败", 
        description: error.message,
        variant: "destructive" 
      });
    }
  });

  return { createOrder };
};
```

### 3. 样式规范

#### Tailwind CSS使用
```tsx
// 使用cn函数合并类名
import { cn } from "@/lib/utils";

const Button = ({ variant, className, ...props }) => {
  return (
    <button
      className={cn(
        "px-4 py-2 rounded-md font-medium transition-colors",
        {
          "bg-blue-500 text-white hover:bg-blue-600": variant === "primary",
          "bg-gray-200 text-gray-900 hover:bg-gray-300": variant === "secondary"
        },
        className
      )}
      {...props}
    />
  );
};
```

#### CSS变量使用
```css
/* 主题色彩定义 */
:root {
  --primary: 266 85% 58%;
  --secondary: 187 85% 53%;
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;
}

.dark {
  --primary: 266 85% 58%;
  --background: 222.2 84% 4.9%;
  --foreground: 210 40% 98%;
}
```

---

## 项目管理流程

### 1. Sprint规划

#### Sprint周期
- **时长**: 2周 (10个工作日)
- **开始**: 周一上午Sprint Planning
- **结束**: 隔周五下午Sprint Review

#### 任务分类
```
Epic (史诗)
├── Story (用户故事)
│   ├── Task (开发任务)
│   ├── Bug (缺陷修复)
│   └── Spike (技术调研)
└── Documentation (文档任务)
```

#### 估点系统 (Fibonacci)
```
1点  - 简单任务 (1-2小时)
2点  - 小型任务 (半天)
3点  - 中型任务 (1天)
5点  - 大型任务 (2-3天)
8点  - 复杂任务 (1周)
13点 - 需要拆分的任务
```

### 2. 每日站会

#### 会议结构 (15分钟)
1. **昨天完成**: 具体完成的任务
2. **今天计划**: 具体计划完成的任务
3. **遇到阻碍**: 需要协助解决的问题

#### 站会模板
```
姓名: 张三
昨天完成: 
- 完成订单创建API开发 (#123)
- 修复支付状态更新Bug (#124)

今天计划:
- 集成Stripe支付流程 (#125)
- 编写API文档 (#126)

遇到问题:
- Stripe webhook配置需要后端支持
```

### 3. 任务跟踪工具

#### 推荐工具
1. **Jira**: 企业级项目管理
2. **Linear**: 现代化任务管理
3. **GitHub Projects**: 代码集成的项目管理
4. **Notion**: 文档和任务结合管理

#### 任务状态流
```
Todo → In Progress → Code Review → Testing → Done
  ↓         ↓           ↓          ↓
Backlog  Blocked    Need Rework  Bug Found
```

---

## 沟通协议

### 1. 会议规范

#### 定期会议
- **每日站会**: 每天上午9:30 (15分钟)
- **Sprint Planning**: 每两周一次 (2小时)
- **Sprint Review**: 每两周一次 (1小时)
- **技术分享**: 每周一次 (1小时)

#### 会议最佳实践
1. **准时参加**: 提前2分钟进入会议室
2. **简洁高效**: 直接切入主题，避免冗长讨论
3. **记录要点**: 重要决策和行动项需要记录
4. **后续跟进**: 会后24小时内发送会议纪要

### 2. 异步沟通

#### 沟通工具选择
```
紧急事项 (2小时内回复): 电话/微信
工作讨论 (当天回复): Slack/钉钉
项目更新 (48小时内回复): 邮件/飞书
技术讨论: GitHub Issues/PR评论
文档协作: 腾讯文档/Notion
```

#### 消息格式规范
```markdown
## 标题明确
**主题**: 支付API集成问题讨论

**背景**: 在集成Stripe支付时遇到webhook配置问题

**问题描述**: 
1. webhook URL无法验证
2. 支付状态回调失败

**需要协助**: 后端配置webhook endpoint

**截止时间**: 今天下午5点前

**相关人员**: @后端开发 @技术负责人
```

### 3. 文档管理

#### 文档分类
```
项目文档/
├── 需求文档/
│   ├── PRD产品需求文档
│   └── API接口文档
├── 技术文档/
│   ├── 架构设计文档
│   ├── 数据库设计文档
│   └── 部署运维文档
├── 团队文档/
│   ├── 开发规范文档
│   ├── 代码审查标准
│   └── 团队协作指南
└── 会议记录/
    ├── Sprint Planning记录
    └── 技术讨论记录
```

#### 文档维护规范
1. **实时更新**: 重要变更立即更新文档
2. **版本管理**: 重要文档保留版本历史
3. **权限控制**: 核心文档限制编辑权限
4. **定期审查**: 每月检查文档有效性

---

## 质量保障体系

### 1. 测试策略

#### 测试金字塔
```
E2E Tests (端到端测试)     10%
├── 关键用户流程验证
└── 跨浏览器兼容性测试

Integration Tests (集成测试)  20%
├── API接口测试
├── 数据库集成测试
└── 第三方服务集成测试

Unit Tests (单元测试)     70%
├── 组件测试
├── 工具函数测试
└── 业务逻辑测试
```

#### 测试覆盖率要求
- **新功能**: 单元测试覆盖率 > 80%
- **核心业务逻辑**: 单元测试覆盖率 > 90%
- **API接口**: 集成测试覆盖率 > 85%
- **关键用户路径**: E2E测试覆盖率 100%

### 2. 代码质量检查

#### 自动化检查工具
```json
{
  "scripts": {
    "lint": "eslint . --ext .ts,.tsx",
    "type-check": "tsc --noEmit",
    "test": "jest",
    "test:coverage": "jest --coverage",
    "build": "vite build",
    "preview": "vite preview"
  }
}
```

#### 质量门禁
- **TypeScript编译**: 无类型错误
- **ESLint检查**: 无错误和警告
- **单元测试**: 全部通过且覆盖率达标
- **构建成功**: 生产环境构建无错误

### 3. 性能监控

#### 关键指标
```typescript
// 性能监控指标
interface PerformanceMetrics {
  // 页面加载性能
  FirstContentfulPaint: number;    // 首次内容绘制
  LargestContentfulPaint: number;  // 最大内容绘制
  CumulativeLayoutShift: number;   // 累积布局偏移
  
  // API响应性能
  ApiResponseTime: number;         // API响应时间
  DatabaseQueryTime: number;       // 数据库查询时间
  
  // 实时流性能
  StreamLatency: number;           // 流延迟
  ConnectionSuccess: number;       // 连接成功率
}
```

---

## 部署与运维

### 1. 环境管理

#### 环境分类
```
开发环境 (Development)
├── 本地开发环境
├── 功能测试环境
└── 集成测试环境

预生产环境 (Staging)
├── 性能测试环境
└── 用户验收测试环境

生产环境 (Production)
├── 生产主环境
└── 灾备环境
```

#### 环境配置管理
```typescript
// 环境变量配置
interface EnvironmentConfig {
  NODE_ENV: 'development' | 'staging' | 'production';
  DATABASE_URL: string;
  STRIPE_SECRET_KEY: string;
  VITE_STRIPE_PUBLIC_KEY: string;
  WEBSOCKET_URL: string;
  LOG_LEVEL: 'debug' | 'info' | 'warn' | 'error';
}
```

### 2. 持续集成/持续部署 (CI/CD)

#### GitHub Actions工作流
```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install dependencies
        run: npm ci
      - name: Run tests
        run: npm run test:coverage
      - name: Type check
        run: npm run type-check
      - name: Lint
        run: npm run lint
      
  deploy:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to production
        run: echo "Deploy to production"
```

### 3. 监控与告警

#### 监控指标
```typescript
// 系统监控指标
interface SystemMetrics {
  // 应用性能
  responseTime: number;
  errorRate: number;
  throughput: number;
  
  // 系统资源
  cpuUsage: number;
  memoryUsage: number;
  diskUsage: number;
  
  // 业务指标
  activeUsers: number;
  orderCreationRate: number;
  paymentSuccessRate: number;
}
```

#### 告警规则
- **错误率 > 5%**: 立即告警
- **响应时间 > 3秒**: 警告告警
- **CPU使用率 > 80%**: 警告告警
- **内存使用率 > 90%**: 严重告警
- **支付失败率 > 2%**: 立即告警

---

## 安全规范

### 1. 代码安全

#### 安全检查清单
```markdown
- [ ] 输入验证：所有用户输入必须验证
- [ ] SQL注入防护：使用参数化查询
- [ ] XSS防护：输出内容转义
- [ ] CSRF防护：使用CSRF令牌
- [ ] 敏感信息：不在代码中硬编码密钥
- [ ] 权限验证：API接口权限检查
- [ ] 数据加密：敏感数据加密存储
- [ ] 安全头：设置安全HTTP头
```

#### 敏感信息管理
```bash
# 环境变量示例
DATABASE_URL="postgresql://user:pass@localhost:5432/taplive"
STRIPE_SECRET_KEY="sk_test_..."
JWT_SECRET="complex-random-string"

# 不要提交到代码仓库
echo ".env" >> .gitignore
echo ".env.local" >> .gitignore
```

### 2. 数据安全

#### 数据保护策略
1. **数据分类**: 公开、内部、机密、绝密
2. **访问控制**: 基于角色的权限控制
3. **数据加密**: 传输和存储加密
4. **数据备份**: 定期备份和恢复测试
5. **数据脱敏**: 测试环境数据脱敏

---

## 国际化协作

### 1. 时区管理

#### 团队时区分布
```
主要工作时区：
- UTC+8  (北京): 核心开发团队
- UTC+0  (伦敦): 产品和设计团队  
- UTC-5  (纽约): 商务和运营团队
- UTC-8  (洛杉矶): 测试和支持团队

重叠工作时间：
- 亚洲-欧洲: UTC+8的9:00-12:00 (UTC+0的1:00-4:00)
- 欧洲-美东: UTC+0的13:00-17:00 (UTC-5的8:00-12:00)
- 全球会议: UTC+8的21:00 (UTC+0的13:00, UTC-5的8:00)
```

#### 异步工作流程
1. **任务交接**: 详细的任务状态记录
2. **文档同步**: 关键决策及时文档化
3. **进度更新**: 每日工作进度异步更新
4. **问题跟踪**: 问题和解决方案详细记录

### 2. 多语言支持

#### 代码国际化
```typescript
// 语言配置
export const languages = {
  zh: '中文',
  en: 'English',
  es: 'Español',
  fr: 'Français',
  de: 'Deutsch',
  ja: '日本語',
  ko: '한국어'
} as const;

// 翻译函数
export const useTranslation = () => {
  const [lang, setLang] = useState<keyof typeof languages>('en');
  
  const t = (key: string): string => {
    return translations[lang]?.[key] || key;
  };
  
  return { t, lang, setLang };
};
```

#### 文档多语言版本
- **中文版**: 面向中国团队的详细文档
- **英文版**: 面向国际团队的标准文档  
- **技术文档**: 英文为主，关键部分提供中文注释

---

## 团队培训与成长

### 1. 技能发展计划

#### 技术能力提升
```
初级开发者 (Junior):
├── React基础和最佳实践
├── TypeScript类型系统
├── CSS/Tailwind样式开发
└── Git版本控制

中级开发者 (Mid-level):
├── 系统设计能力
├── 性能优化技巧
├── 测试驱动开发
└── API设计原则

高级开发者 (Senior):
├── 架构设计能力
├── 团队协作领导
├── 技术方案评估
└── 跨团队沟通
```

#### 学习资源
- **官方文档**: React, Node.js, PostgreSQL
- **在线课程**: Udemy, Coursera, Pluralsight
- **技术博客**: Medium, Dev.to, 掘金
- **开源项目**: GitHub优秀项目学习
- **技术会议**: 参与行业技术大会

### 2. 知识分享

#### 技术分享会
```
每周分享主题：
第1周: React最新特性和最佳实践
第2周: Node.js性能优化技巧  
第3周: 数据库设计和优化
第4周: WebRTC和实时通信
第5周: 支付系统集成经验
```

#### 文档贡献激励
- **技术博客**: 鼓励团队成员写技术博客
- **内部分享**: 项目经验和踩坑记录分享
- **外部演讲**: 参与技术会议演讲
- **开源贡献**: 参与相关开源项目

---

本团队协作文档为TapLive MVP项目的国际化团队提供了完整的协作指南，涵盖了从技术开发到项目管理的各个方面。团队成员应定期更新和优化本文档，确保协作流程的持续改进。